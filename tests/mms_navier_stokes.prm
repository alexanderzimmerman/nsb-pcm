# Listing of Parameters
# ---------------------
subsection meta

    set dim = 2
    
end

subsection geometry

    set grid_name = hyper_shell
    
    set sizes = 0.1, 0.5
    
end


subsection source_function

    set Function constants = r0=0.1, beta=10., Re=1., gamma=1.e-7
    
    set Function expression = x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))*(y^2*(1 - exp(-beta*t^2))/(x^2 + y^2) - y^2*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2) + (1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2))/sqrt(x^2 + y^2) + 2*x*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2) + 2*y*beta*t*(-r0 + sqrt(x^2 + y^2))*exp(-beta*t^2)/sqrt(x^2 + y^2) + y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))*(x*y*(1 - exp(-beta*t^2))/(x^2 + y^2) - x*y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2))/sqrt(x^2 + y^2) - mu*(-3*y^3*(1 - exp(-beta*t^2))/(x^2 + y^2)^2 + 3*y^3*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(5/2) + 3*y*(1 - exp(-beta*t^2))/(x^2 + y^2) - 3*y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2)) - mu*(-3*x^2*y*(1 - exp(-beta*t^2))/(x^2 + y^2)^2 + 3*x^2*y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(5/2) + y*(1 - exp(-beta*t^2))/(x^2 + y^2) - y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2)); -2*x*beta*t*(-r0 + sqrt(x^2 + y^2))*exp(-beta*t^2)/sqrt(x^2 + y^2) + x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))*(x*y*(-1 + exp(-beta*t^2))/(x^2 + y^2) - x*y*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2))/sqrt(x^2 + y^2) + y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))*(x^2*(-1 + exp(-beta*t^2))/(x^2 + y^2) - x^2*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2) + (-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2))/sqrt(x^2 + y^2) + 2*y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2) - mu*(-3*x^3*(-1 + exp(-beta*t^2))/(x^2 + y^2)^2 + 3*x^3*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(5/2) + 3*x*(-1 + exp(-beta*t^2))/(x^2 + y^2) - 3*x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2)) - mu*(-3*x*y^2*(-1 + exp(-beta*t^2))/(x^2 + y^2)^2 + 3*x*y^2*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(5/2) + x*(-1 + exp(-beta*t^2))/(x^2 + y^2) - x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2)); x*y*(-1 + exp(-beta*t^2))/(x^2 + y^2) - x*y*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2) + x*y*(1 - exp(-beta*t^2))/(x^2 + y^2) - x*y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/(x^2 + y^2)^(3/2) + gamma*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))^2; 0.
    
end

subsection initial_values

    set Function expression = 0.; 0.; 0.; 0.
    
end


subsection boundary_conditions

    set strong_mask = velocity, velocity, velocity
    
    set parsed_function
    
        set Function constants = r0=0.1, beta=10.
        
        set Function expression = y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2); x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2); (1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))^2; 0.
        
    end
    
end


subsection verification
    
    set enabled = true
    
    set parsed_exact_solution_function
    
        set Function constants = r0=0.1, beta=10.
        
        set Function expression = y*(1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2); x*(-1 + exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))/sqrt(x^2 + y^2); (1 - exp(-beta*t^2))*(-r0 + sqrt(x^2 + y^2))^2; 0.
        
    end
    
end


subsection refinement

    set initial_global_cycles = 2
    
end


subsection nonlinear_solver

    set max_iterations = 50
    
    set tolerance = 1.e-8
    
end


subsection time

    set end = 1.
    
    set initial_step_size = 0.5
    
    set min_step_size = 0.5
    
    set max_step_size = 0.5
    
end


subsection output

    set write_solution_vtk = true
    
end
