# Hot fluid entering one end of a pipe with adiabatic walls. Outflow condition on the other end
subsection meta
    set dim = 2
end

subsection physics
    
    set gravity = 0., 0.
    
    set prescribe_convection_velocity = true
    
    subsection prescribed_convection_velocity_function
        set Function constants = huge=1.e16
        set Function expression = 1.; 0.; huge; huge
    end
    
end

subsection geometry
    set grid_name = hyper_rectangle
    set sizes = 0., 0., 1., 0.5
end

subsection initial_values
    set Function constants = epsilon=1.e-8
    
    set Function expression = if(x<epsilon, 1., 0); 0.; 0.; if(x<epsilon, 1., 0)
end

subsection boundary_conditions
    
    set strong_boundaries = 0, 2, 3
    
    set strong_masks = velocity; temperature,  velocity,  velocity
    
    set Function constants = epsilon=1.e-8
    
    set Function expression = 1.; 0.; 0.; if(x<epsilon, 1., 0)
    
end

subsection refinement
    set initial_global_cycles = 2
end

subsection nonlinear_solver
    set max_iterations = 50
    set tolerance = 1.e-9
end

subsection time
    set end = 10.
    set initial_step_size = 1.
    set min_step_size = 1.
    set max_step_size = 10.
end

subsection output
    set write_solution_vtk = true
end
